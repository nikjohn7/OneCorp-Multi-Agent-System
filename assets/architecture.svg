<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1400" width="1200" height="1400">
  <!-- Title -->
  <text x="600" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
    OneCorp Multi-Agent System Architecture
  </text>

  <!-- Legend -->
  <g id="legend">
    <text x="50" y="60" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1a1a1a">Legend:</text>
    <line x1="50" y1="75" x2="90" y2="75" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowblue)"/>
    <text x="100" y="80" font-family="Arial, sans-serif" font-size="12" fill="#1a1a1a">Data Flow</text>
    <line x1="200" y1="75" x2="240" y2="75" stroke="#dc2626" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowred)"/>
    <text x="250" y="80" font-family="Arial, sans-serif" font-size="12" fill="#1a1a1a">Control Flow</text>
  </g>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#2563eb"/>
    </marker>
    <marker id="arrowred" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#dc2626"/>
    </marker>
  </defs>

  <!-- External System: Shared Inbox -->
  <g id="shared-inbox">
    <rect x="450" y="100" width="300" height="80" fill="#f3f4f6" stroke="#6b7280" stroke-width="2" rx="5"/>
    <text x="600" y="130" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937">SHARED INBOX</text>
    <text x="600" y="155" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#4b5563">support@onecorpaustralia.com.au</text>
    <text x="600" y="170" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#6b7280">EOI emails, Contracts, Vendor emails</text>
  </g>

  <!-- Router Agent -->
  <g id="router">
    <rect x="450" y="230" width="300" height="100" fill="#dbeafe" stroke="#2563eb" stroke-width="3" rx="8"/>
    <text x="600" y="260" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">ROUTER AGENT</text>
    <text x="600" y="280" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#1e40af">(DeepSeek V3.2)</text>
    <text x="600" y="300" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#1e3a8a">• Classify emails by event type</text>
    <text x="600" y="315" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#1e3a8a">• Extract identifiers (lot, purchasers)</text>
  </g>

  <!-- Data flow: Inbox -> Router -->
  <line x1="600" y1="180" x2="600" y2="230" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowblue)"/>

  <!-- Extractor Agent -->
  <g id="extractor">
    <rect x="100" y="410" width="280" height="110" fill="#dbeafe" stroke="#2563eb" stroke-width="3" rx="8"/>
    <text x="240" y="440" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1e3a8a">EXTRACTOR AGENT</text>
    <text x="240" y="460" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#1e40af">(DeepSeek V3.2)</text>
    <text x="240" y="480" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#1e3a8a">• Parse PDFs (EOI, contracts)</text>
    <text x="240" y="495" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#1e3a8a">• Extract structured fields</text>
    <text x="240" y="510" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#1e3a8a">• Confidence scoring (0.0-1.0)</text>
  </g>

  <!-- Data flow: Router -> Extractor -->
  <path d="M 450,280 L 380,280 L 380,465 L 380,465" stroke="#2563eb" stroke-width="2" fill="none" marker-end="url(#arrowblue)"/>
  <text x="395" y="350" font-family="Arial, sans-serif" font-size="10" fill="#2563eb">PDF attachments</text>

  <!-- Auditor Agent -->
  <g id="auditor">
    <rect x="820" y="410" width="280" height="130" fill="#fef3c7" stroke="#f59e0b" stroke-width="3" rx="8"/>
    <text x="960" y="440" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#92400e">AUDITOR AGENT</text>
    <text x="960" y="460" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#b45309">(Qwen3-235B)</text>
    <text x="960" y="480" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Compare contract vs EOI</text>
    <text x="960" y="495" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Detect mismatches</text>
    <text x="960" y="510" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Severity classification</text>
    <text x="960" y="525" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Risk scoring (LOW/MED/HIGH)</text>
  </g>

  <!-- Data flow: Extractor -> Auditor -->
  <path d="M 380,465 L 520,465 L 520,475 L 820,475" stroke="#2563eb" stroke-width="2" fill="none" marker-end="url(#arrowblue)"/>
  <text x="575" y="460" font-family="Arial, sans-serif" font-size="10" fill="#2563eb">Extracted data</text>

  <!-- Orchestrator (State Machine) -->
  <g id="orchestrator">
    <rect x="400" y="620" width="400" height="140" fill="#f0fdf4" stroke="#16a34a" stroke-width="3" rx="8"/>
    <text x="600" y="650" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#14532d">ORCHESTRATOR</text>
    <text x="600" y="670" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#15803d">(Deterministic Python - No LLM)</text>
    <text x="600" y="690" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#14532d">• State machine (15 states, 12 event types)</text>
    <text x="600" y="705" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#14532d">• Workflow guardrails &amp; rules</text>
    <text x="600" y="720" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#14532d">• Contract version management</text>
    <text x="600" y="735" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#14532d">• SLA deadline scheduling</text>
    <text x="600" y="750" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#14532d">• Trigger email generation</text>
  </g>

  <!-- Control flow: Router -> Orchestrator -->
  <line x1="600" y1="330" x2="600" y2="620" stroke="#dc2626" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowred)"/>
  <text x="610" y="475" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">Event: EOI_SIGNED,</text>
  <text x="610" y="490" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">CONTRACT_FROM_VENDOR,</text>
  <text x="610" y="505" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">SOLICITOR_APPROVED...</text>

  <!-- Control flow: Auditor -> Orchestrator -->
  <path d="M 960,540 L 960,580 L 800,580 L 800,680" stroke="#dc2626" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowred)"/>
  <text x="810" y="575" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">VALIDATION_PASSED/</text>
  <text x="810" y="590" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">VALIDATION_FAILED</text>

  <!-- Comms Agent -->
  <g id="comms">
    <rect x="820" y="820" width="280" height="130" fill="#fef3c7" stroke="#f59e0b" stroke-width="3" rx="8"/>
    <text x="960" y="850" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#92400e">COMMS AGENT</text>
    <text x="960" y="870" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#b45309">(Qwen3-235B)</text>
    <text x="960" y="890" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Generate outbound emails</text>
    <text x="960" y="905" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Contract to solicitor</text>
    <text x="960" y="920" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Vendor DocuSign release</text>
    <text x="960" y="935" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#92400e">• Discrepancy &amp; SLA alerts</text>
  </g>

  <!-- Control flow: Orchestrator -> Comms -->
  <path d="M 800,690 L 850,690 L 850,885 L 820,885" stroke="#dc2626" stroke-width="2" stroke-dasharray="5,5" fill="none" marker-end="url(#arrowred)"/>
  <text x="860" y="790" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">Trigger email</text>
  <text x="860" y="805" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">generation</text>

  <!-- Deal Store -->
  <g id="deal-store">
    <rect x="100" y="820" width="250" height="100" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2" rx="5"/>
    <text x="225" y="850" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#312e81">DEAL STORE</text>
    <text x="225" y="870" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#4338ca">(SQLite Database)</text>
    <text x="225" y="890" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#312e81">• Deal state persistence</text>
    <text x="225" y="905" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#312e81">• Contract versions</text>
  </g>

  <!-- Bidirectional data flow: Orchestrator <-> Deal Store -->
  <path d="M 400,700 L 350,700 L 350,870 L 350,870" stroke="#2563eb" stroke-width="2" fill="none" marker-end="url(#arrowblue)"/>
  <path d="M 355,865 L 355,705 L 400,705" stroke="#2563eb" stroke-width="2" fill="none" marker-end="url(#arrowblue)"/>
  <text x="360" y="780" font-family="Arial, sans-serif" font-size="10" fill="#2563eb">Read/Write</text>
  <text x="360" y="795" font-family="Arial, sans-serif" font-size="10" fill="#2563eb">deal state</text>

  <!-- SLA Monitor -->
  <g id="sla-monitor">
    <rect x="100" y="620" width="250" height="100" fill="#e0e7ff" stroke="#4f46e5" stroke-width="2" rx="5"/>
    <text x="225" y="650" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#312e81">SLA MONITOR</text>
    <text x="225" y="670" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#4338ca">(Deterministic Timer)</text>
    <text x="225" y="690" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#312e81">• Track appointment deadlines</text>
    <text x="225" y="705" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#312e81">• Evaluate overdue deals</text>
  </g>

  <!-- Control flow: SLA Monitor -> Orchestrator -->
  <line x1="350" y1="670" x2="400" y2="670" stroke="#dc2626" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowred)"/>
  <text x="360" y="665" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">SLA_OVERDUE</text>

  <!-- Output: Emails sent -->
  <g id="outbound-emails">
    <rect x="820" y="1020" width="280" height="100" fill="#f3f4f6" stroke="#6b7280" stroke-width="2" rx="5"/>
    <text x="960" y="1050" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937">OUTBOUND EMAILS</text>
    <text x="960" y="1075" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#4b5563">• Contract to solicitor</text>
    <text x="960" y="1090" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#4b5563">• Vendor DocuSign release</text>
    <text x="960" y="1105" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#4b5563">• Internal alerts (discrepancy, SLA)</text>
  </g>

  <!-- Data flow: Comms -> Outbound -->
  <line x1="960" y1="950" x2="960" y2="1020" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowblue)"/>

  <!-- Workflow States Box -->
  <g id="workflow-states">
    <rect x="50" y="1180" width="1100" height="170" fill="#fef9e7" stroke="#f59e0b" stroke-width="2" rx="5"/>
    <text x="600" y="1210" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#92400e">KEY WORKFLOW STATES</text>

    <!-- State flow diagram -->
    <g id="state-flow">
      <circle cx="100" cy="1250" r="25" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
      <text x="100" y="1255" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#1e3a8a">EOI</text>

      <path d="M 125,1250 L 165,1250" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowblack)"/>

      <circle cx="190" cy="1250" r="25" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
      <text x="190" y="1255" font-family="Arial, sans-serif" font-size="9" font-weight="bold" text-anchor="middle" fill="#92400e">V1</text>

      <path d="M 190,1275 L 190,1295" stroke="#dc2626" stroke-width="2" marker-end="url(#arrowred)"/>
      <text x="195" y="1290" font-family="Arial, sans-serif" font-size="9" fill="#dc2626">failed</text>

      <circle cx="190" cy="1310" r="20" fill="#fee2e2" stroke="#dc2626" stroke-width="2"/>
      <text x="190" y="1315" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#991b1b">Alert</text>

      <path d="M 210,1310 L 280,1310 L 280,1250 L 255,1250" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowblack)"/>

      <circle cx="330" cy="1250" r="25" fill="#d1fae5" stroke="#16a34a" stroke-width="2"/>
      <text x="330" y="1255" font-family="Arial, sans-serif" font-size="9" font-weight="bold" text-anchor="middle" fill="#14532d">V2</text>

      <path d="M 330,1225 L 330,1210" stroke="#16a34a" stroke-width="2" marker-end="url(#arrowgreen)"/>
      <text x="335" y="1215" font-family="Arial, sans-serif" font-size="9" fill="#16a34a">valid</text>

      <circle cx="420" cy="1250" r="25" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
      <text x="420" y="1252" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#1e3a8a">Sent to</text>
      <text x="420" y="1262" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#1e3a8a">Solicitor</text>

      <path d="M 355,1250 L 395,1250" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowblack)"/>

      <path d="M 445,1250 L 485,1250" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowblack)"/>

      <circle cx="510" cy="1250" r="25" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
      <text x="510" y="1252" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#1e3a8a">Solicitor</text>
      <text x="510" y="1262" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#1e3a8a">Approved</text>

      <path d="M 535,1250 L 575,1250" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowblack)"/>

      <circle cx="600" cy="1250" r="25" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
      <text x="600" y="1252" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#92400e">DocuSign</text>
      <text x="600" y="1262" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#92400e">Released</text>

      <path d="M 625,1250 L 665,1250" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowblack)"/>

      <circle cx="690" cy="1250" r="25" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
      <text x="690" y="1252" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#1e3a8a">Buyer</text>
      <text x="690" y="1262" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#1e3a8a">Signed</text>

      <path d="M 715,1250 L 755,1250" stroke="#1f2937" stroke-width="2" marker-end="url(#arrowblack)"/>

      <circle cx="780" cy="1250" r="25" fill="#d1fae5" stroke="#16a34a" stroke-width="2"/>
      <text x="780" y="1255" font-family="Arial, sans-serif" font-size="9" font-weight="bold" text-anchor="middle" fill="#14532d">EXECUTED</text>

      <!-- SLA Alert path -->
      <path d="M 600,1275 L 600,1310 L 850,1310" stroke="#dc2626" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrowred)"/>
      <text x="660" y="1305" font-family="Arial, sans-serif" font-size="9" fill="#dc2626">SLA overdue if no buyer signature</text>

      <circle cx="870" cy="1310" r="20" fill="#fee2e2" stroke="#dc2626" stroke-width="2"/>
      <text x="870" y="1315" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="#991b1b">SLA Alert</text>
    </g>
  </g>

  <!-- Additional arrow markers -->
  <defs>
    <marker id="arrowblack" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#1f2937"/>
    </marker>
    <marker id="arrowgreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#16a34a"/>
    </marker>
  </defs>

  <!-- Footer note -->
  <text x="600" y="1380" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#6b7280" font-style="italic">
    Pattern-based, generalizable architecture - works for any property deal
  </text>
</svg>
